/** * Created by zengtao on 18/8/1. */define(['/Modules/Config/conwin.main.js'], function () {    require(['jquery', 'system', 'helper', 'bootstrap-datepicker.zh-CN'],        function ($, system, helper) {            $.ajax({                url: system.ClentIpUrl,                dataType: "json",                type: "get",                success: function (req) {                    sessionStorage.setItem('ip', req.cip); // 存入一个值                },            });            $('.ublas').click(function () {                var browserInfo = getBrowserInfo();                //获取IP                var nowIp = sessionStorage.getItem("ip");                //获取当前时间                var nowTime = getNowTime();                if (helper.GetUserInfo()) {                    //获取用户信息                    var userInfo = helper.GetUserInfo();                    var sysId = userInfo.SysId;                    var accountName = userInfo.AccountName;                    var id = userInfo.Id;                } else {                    var accountName = "";                    var id = "";                }                var type = 1;                var resId = $(this)["0"].attributes[2].nodeValue;                var data = {                    "SysId": sysId,                    "Account": accountName,                    "UserId": id,                    "Time": nowTime,                    "ResId": resId,                    "Type": type,                    "IP": nowIp,                    "ClientOS": browserInfo,                    "Content":"",                    "Device": ""                };                helper.Ajax("000002600001", [data], function (result) {                    if (result.publicresponse.statuscode == 0) {                        console.log(result.body);                    }                    else {                        console.log(result.message);                    }                }, false);            })            function getServerDate(){                return new Date($.ajax({async: false}).getResponseHeader("Date"));            }            /**             * 获取当前时间             * */            function getNowTime() {                var myDate = new Date();                var year = myDate.getFullYear();                var month;                if (myDate.getMonth() < 10) {                    month = "0" + (myDate.getMonth() + 1);                } else {                    month = myDate.getMonth() + 1;                }                var day;                if (myDate.getDate() < 10) {                    day = "0" + myDate.getDate();                } else {                    day = myDate.getDate();                }                var hours;                if (myDate.getHours() < 10) {                    hours = "0" + myDate.getHours();                } else {                    hours = myDate.getHours();                }                var minutes;                if (myDate.getMinutes() < 9) {                    minutes = "0" + (myDate.getMinutes() + 1);                } else {                    minutes = myDate.getMinutes();                }                var seconds;                if (myDate.getSeconds() < 10) {                    seconds = "0" + (myDate.getSeconds() + 1);                } else {                    seconds = myDate.getSeconds() + 1;                }                var secondsNumber;                if (myDate.getMilliseconds() < 10) {                    secondsNumber = "00" + (myDate.getMilliseconds() + 1);                } else if (myDate.getMilliseconds() > 10 && myDate.getMilliseconds() < 100) {                    secondsNumber = "0" + myDate.getMilliseconds();                } else {                    secondsNumber = myDate.getMilliseconds();                }                return year.toString() + month.toString() + day.toString() + hours.toString() + minutes.toString() + seconds.toString() + secondsNumber.toString();            }            /**             * 获取当前操作系统及版本号             * */            function getBrowserInfo() {                var agent = navigator.userAgent.toLowerCase();                return agent;                /*var arr = [];                var system = agent.split(' ')[1].split(' ')[0].split('(')[1];                arr.push(system);                var regStr_edge = /edge\/[\d.]+/gi;                var regStr_ie = /trident\/[\d.]+/gi ;                var regStr_ff = /firefox\/[\d.]+/gi;                var regStr_chrome = /chrome\/[\d.]+/gi ;                var regStr_saf = /safari\/[\d.]+/gi ;                var regStr_opera = /opr\/[\d.]+/gi;                //IE                if(agent.indexOf("trident") > 0){                    arr.push(agent.match(regStr_ie)[0].split('/')[0]);                    arr.push(agent.match(regStr_ie)[0].split('/')[1]);                    return arr;                }                //Edge                if(agent.indexOf('edge') > 0){                    arr.push(agent.match(regStr_edge)[0].split('/')[0]);                    arr.push(agent.match(regStr_edge)[0].split('/')[1]);                    return arr;                }                //firefox                if(agent.indexOf("firefox") > 0){                    arr.push(agent.match(regStr_ff)[0].split('/')[0]);                    arr.push(agent.match(regStr_ff)[0].split('/')[1]);                    return arr;                }                //Opera                if(agent.indexOf("opr")>0){                    arr.push(agent.match(regStr_opera)[0].split('/')[0]);                    arr.push(agent.match(regStr_opera)[0].split('/')[1]);                    return arr;                }                //Safari                if(agent.indexOf("safari") > 0 && agent.indexOf("chrome") < 0){                    arr.push(agent.match(regStr_saf)[0].split('/')[0]);                    arr.push(agent.match(regStr_saf)[0].split('/')[1]);                    return arr;                }                //Chrome                if(agent.indexOf("chrome") > 0){                    arr.push(agent.match(regStr_chrome)[0].split('/')[0]);                    arr.push(agent.match(regStr_chrome)[0].split('/')[1]);                    return arr;                }else{                    arr.push('请更换主流浏览器，例如chrome,firefox,opera,safari,IE,Edge!')                    return arr;                }*/            }        })});