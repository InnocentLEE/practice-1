<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.lyq.project.dao.GNMapper" >

  <select id="selectByparentUnitId" parameterType="java.lang.String" resultType="java.lang.String">
    select id
    from unit
    where city is not null
  </select>

  <select id="selectShiJiJianGuanBuMen" resultType="com.lyq.project.dto.ShiJiJianGuanBuMenListDto">
    select u.id as Id, u.unit_name as UnitName, u.city as City, u.in_net_date as InNetDate, c.contact_name as ContactMen
    from unit u, contacts c
    where u.contacts_id = c.id and u.OrgType = 2
    <if test="unitName != null and unitName != ''" >
      and u.unit_name like concat('%',#{unitName},'%')
    </if>
    <if test="province != null and province != ''" >
      and u.province = #{province}
    </if>
    <if test="city != null and city != ''" >
      and u.city = #{city}
    </if>
    limit #{index} , #{size}
  </select>

  <select id="selectShiJiJianGuanBuMenDetail" resultType="com.lyq.project.dto.ShiJiJianGuanBuMenDetail">
    select u.id as Id, u.unit_name as UnitName, u.province as Province, u.city as City, u.in_net_date as InNetDate, u.address as Address,
    c.contact_name as Name, c.cardNo as IdCard, c.tel as Tel, c.phone as Phone, c.email as Email, c.QQ as QQ, c.memo as Memo
    from unit u, contacts c
    where u.contacts_id = c.id and u.id = #{id}
  </select>

  <delete id="deleteShiJiJianGuanBuMenUnitGather">
    delete from unit_gather
    where unit_id = #{unit_id}
  </delete>
</mapper>